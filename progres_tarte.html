<div id="progres_tarte">   <!-- debut de la tarte-->
  <div>Pourcentage de progrès:
    <span id="affichageInteractive"></span>
    </div> 
    <div id="flotcontainer" style="width: 600px;height:400px; text-align: left;"></div> 
</div> 

<!-- Javascript --> 
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
<script src="http://www.pureexample.com/js/flot/excanvas.min.js"></script> 
<script src="http://www.pureexample.com/js/flot/jquery.flot.min.js"></script> 
<script src="http://www.pureexample.com/js/flot/jquery.flot.pie.min.js"></script> 
<script type="text/javascript"> 
  var uniteLength;
  var uniteEnCoursTitre;

  var recupererIndexCurrentUnit = function(){
    var myUrl_Get = "http://localhost:8111/platoatic/parcours ";

    console.log("afficheParcourUnites : " + myUrl_Get);

    $.ajax({
      url: myUrl_Get,
      type: "GET",
      dataType: "json",

      success: function(data) {
        uniteLength = data.unite.length;

        if (uniteLength > 0){
          var index = 0;
          var UnitEnCours=0;
          //recherche l'id de l'unite en cours - la premiere unite non faite
          while (UnitEnCours == 0){
            if (IsUniteDone(data.unite[index].UnitID)){
                index++;
            }
            else{
            UnitEnCours=data.unite[index].UnitID;
            //index ++;
            }     
          }
          uniteEnCoursTitre = data.unite[index].title;
          return index;
        } 
      },
      error:  function() {
        console.log('afficheParcoursRessources : GET process error');
        $("#mesProgres").html('myUrl_Get');
      }
    });  // fin d'appel Ajax
  };   // fin de fonction recupererIndexCurrentUnit

  var UnitEnCoursIndex = recupererIndexCurrentUnit();

  $(function () 
  { var data = [
      {label: "à faire", data: uniteLength - UnitEnCoursIndex, color: 'gray'}, 
      {label: "en cours : " + uniteEnCoursTitre, data: 1, color: 'cyan'}, 
      {label: "fait", data: UnitEnCoursIndex - 1, color: 'green'}
      //{label: "data4", data: 40}, 
      //{label: "data5", data: 50}, 
      //{label: "data6", data: 60}, 
      //{label: "data7", data: 70} 
      ]; 

    var options = 
    { series: 
      { pie: 
        { show: true, 
          radius: 0.4, 
          tilt: 0.5, 

          label:
          { radius: 3/4, 
            formatter: function (label, series) 
            { return '<div style="border:1px solid gray;font-size:8pt;text-align:center;padding:5px;color:white; display:none">' + label + '<br/>' + Math.round(series.percent) + '%</div>'; 
            }, 
            background: { 
              opacity: 0.5, 
              color: '#000' 
            } 
          } 
        } 
      }, 

      legend: 
      { show: 
        false 
      }, 
      grid: 
      { 
        hoverable: true, 
        clickable: true 
      } 
    };     // fin de variable options

    $.plot($("#progres_tarte #flotcontainer"), data, options); 
    $("#progres_tarte #flotcontainer").bind("plothover", function(event, pos, obj)
      { 
        if (!obj)
          {return;} 
        percent = parseFloat(obj.series.percent).toFixed(2); 

        var html = []; 
        html.push("<div style=\"flot:left;width:105px;height:20px;text-align:center;border:none;background-color:", obj.series.color, "\">", "<span style=\"font-weight:bold;color:white\">", obj.series.label, " (", percent, "%)</span>", "</div>"); 
        $("#affichageInteractive").html(html.join('')); 
      }); 
  });   // fin de fontion recuperant le contenu de la tarte

</script>     <!-- fin de la tarte-->